# ?? Medical Appointment Booking API - Documentation

## ?? ???? ?????????
1. [???? ????](#????-????)
2. [?????? ?????????](#??????-?????????)
3. [??? Controllers](#???-controllers)
4. [??? Services](#???-services)
5. [DTOs](#dtos)
6. [Authentication](#authentication)
7. [??? Endpoints](#???-endpoints)

---

## ?? ???? ????
??? ??????? ?? API ???? ????? ??? ?????? ??????? ??:
- ? CRUD ???? ????? ????????
- ? JWT Authentication ? Authorization
- ? Validation ????
- ? Error Handling ????
- ? Service Layer
- ? Repository Pattern ?? Unit of Work
- ? Swagger Documentation

---

## ??? ?????? ?????????

```
Api-Project/
??? Controllers/           # API Controllers
?   ??? AccountController.cs         # ?????/????
?   ??? DoctorsController.cs         # ???????
?   ??? PatientsController.cs        # ??????
?   ??? AppointmentsController.cs    # ????????
?   ??? LocationController.cs        # ???????
?   ??? SpecialtyController.cs       # ????????
?   ??? ReviewsController.cs         # ?????????
?   ??? TimeSlotsController.cs       # ????? ?????
?   ??? DoctorSchedulesController.cs # ????? ???????
?
??? Services/              # Business Logic
?   ??? DoctorService.cs
?   ??? PatientService.cs
?   ??? AppointmentService.cs
?   ??? LocationService.cs
?   ??? SpecialtyService.cs
?   ??? ReviewService.cs
?   ??? TimeSlotService.cs
?   ??? DoctorScheduleService.cs
?
??? DTOs/                  # Data Transfer Objects
?   ??? Patient/
?   ??? Doctors/
?   ??? Appointment/
?   ??? Location/
?   ??? Specialty/
?   ??? Review/
?   ??? TimeSlot/
?   ??? DoctorSchedule/
?   ??? AppUser/
?
??? Models/                # Database Models
?   ??? Doctor.cs
?   ??? Patient.cs
?   ??? Appointment.cs
?   ??? Location.cs
?   ??? Specialty.cs
?   ??? Review.cs
?   ??? TimeSlot.cs
?   ??? DoctorSchedule.cs
?   ??? AppUser.cs
?   ??? BaseEntity.cs
?
??? Repository/            # Data Access Layer
?   ??? GenericRepository.cs
?
??? UnitOfWork/            # Unit of Work Pattern
?   ??? UnitWork.cs
?
??? Context/               # Database Context
?   ??? ApiDbContext.cs
?
??? Responses/             # Response Wrappers
?   ??? ApiResponse.cs
?
??? Migrations/            # Database Migrations
```

---

## ?? ??? Controllers

### 1?? **DoctorsController** - `/api/doctors`
```csharp
GET    /api/doctors                    // ?????? ??? ???? ???????
GET    /api/doctors/{id}               // ?????? ??? ???? ????
GET    /api/doctors/search (POST)      // ????? ?? ?????
POST   /api/doctors                    // ????? ???? ???? [Authorize]
PUT    /api/doctors/{id}               // ????? ???? [Authorize]
DELETE /api/doctors/{id}               // ??? ???? [Authorize]
```

### 2?? **PatientsController** - `/api/patients`
```csharp
GET    /api/patients                   // ?????? ??? ???? ?????? [Authorize]
GET    /api/patients/{id}              // ?????? ??? ???? ???? [Authorize]
POST   /api/patients                   // ????? ???? ????
PUT    /api/patients/{id}              // ????? ?????? ?????? [Authorize]
DELETE /api/patients/{id}              // ??? ???? [Authorize]
```

### 3?? **AppointmentsController** - `/api/appointments`
```csharp
GET    /api/appointments               // ???? ???????? [Authorize]
GET    /api/appointments/{id}          // ??? ???? [Authorize]
GET    /api/appointments/doctor/{id}   // ?????? ???? ???? [Authorize]
GET    /api/appointments/patient/{id}  // ?????? ???? ???? [Authorize]
POST   /api/appointments/patient/{id}  // ????? ??? ???? [Authorize]
PUT    /api/appointments/{id}          // ????? ???? ????? [Authorize]
PUT    /api/appointments/{id}/cancel   // ????? ??? [Authorize]
DELETE /api/appointments/{id}          // ??? ??? [Authorize]
```

### 4?? **LocationController** - `/api/location`
```csharp
GET    /api/location                   // ???? ??????? [Authorize]
GET    /api/location/{id}              // ???? ???? [Authorize]
GET    /api/location/ByName/{name}     // ????? ?????? [Authorize]
POST   /api/location                   // ????? ???? ???? [Authorize]
PUT    /api/location                   // ????? ???? [Authorize]
DELETE /api/location                   // ??? ???? [Authorize]
```

### 5?? **SpecialtyController** - `/api/specialty`
```csharp
GET    /api/specialty                  // ???? ????????
GET    /api/specialty/{id}             // ???? ????
GET    /api/specialty/ByName/{name}    // ????? ??????
POST   /api/specialty                  // ????? ???? [Authorize]
PUT    /api/specialty/{id}             // ????? ???? [Authorize]
DELETE /api/specialty/{id}             // ??? ???? [Authorize]
```

### 6?? **ReviewsController** - `/api/reviews`
```csharp
GET    /api/reviews                    // ???? ????????? [Authorize]
GET    /api/reviews/{id}               // ????? ???? [Authorize]
GET    /api/reviews/doctor/{id}        // ??????? ??????
GET    /api/reviews/doctor/{id}/average-rating  // ????? ???????
GET    /api/reviews/patient/{id}       // ??????? ?????? [Authorize]
POST   /api/reviews/patient/{id}       // ????? ????? ???? [Authorize]
PUT    /api/reviews/{id}/patient/{id}  // ????? ????? [Authorize]
DELETE /api/reviews/{id}               // ??? ????? [Authorize]
```

### 7?? **TimeSlotsController** - `/api/timeslots`
```csharp
GET    /api/timeslots                  // ???? ??????? ??????? [Authorize]
GET    /api/timeslots/{id}             // ???? ????? ????? [Authorize]
GET    /api/timeslots/doctor/{id}/available  // ??????? ???????
POST   /api/timeslots                  // ????? ???? ????? [Authorize]
PUT    /api/timeslots/{id}             // ????? ???? [Authorize]
DELETE /api/timeslots/{id}             // ??? ???? [Authorize]
```

### 8?? **DoctorSchedulesController** - `/api/doctorschedules`
```csharp
GET    /api/doctorschedules            // ???? ??????? [Authorize]
GET    /api/doctorschedules/{id}       // ???? ???? [Authorize]
GET    /api/doctorschedules/doctor/{id}  // ???? ???? ????
POST   /api/doctorschedules            // ????? ???? ???? [Authorize]
PUT    /api/doctorschedules/{id}       // ????? ???? [Authorize]
DELETE /api/doctorschedules/{id}       // ??? ???? [Authorize]
```

### 9?? **AccountController** - `/api/account`
```csharp
POST   /api/account/register           // ????? ???? ????
POST   /api/account/login              // ????? ?????? ?????? Token
```

---

## ?? ??? Services

?? Service ????? ???:
- `GetAll()` - ?????? ??? ???? ???????
- `GetById(int id)` - ?????? ??? ??? ????
- `Create(DTO dto)` - ????? ??? ????
- `Update(int id, DTO dto)` - ????? ???
- `Delete(int id)` - ??? ???

### ???? - DoctorService:
```csharp
public class DoctorService
{
    private readonly UnitWork unitWork;

    public List<DoctorDto> GetAllDoctors() { ... }
    public DoctorDto? GetDoctorById(int id) { ... }
    public List<DoctorDto> SearchDoctors(SearchDoctorDto searchDto) { ... }
    public void Create(CreateDoctorDto doctorDto) { ... }
    public bool Update(int id, CreateDoctorDto doctorDto) { ... }
    public bool Delete(int id) { ... }
}
```

---

## ?? DTOs

### DoctorDto / CreateDoctorDto
```csharp
public class DoctorDto
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int SpecialtyId { get; set; }
    public int LocationId { get; set; }
    public int YearsOfExperience { get; set; }
    public decimal ConsultationFee { get; set; }
    public string? ProfileImage { get; set; }
    public string? Bio { get; set; }
}
```

### PatientDto / CreatePatientDto
```csharp
public class PatientDto
{
    public int Id { get; set; }
    public string FullName { get; set; }
    public DateTime? DateOfBirth { get; set; }
    public Gender Gender { get; set; }
}
```

### AppointmentDto / CreateAppointmentDto
```csharp
public class AppointmentDto
{
    public int Id { get; set; }
    public string DoctorName { get; set; }
    public string PatientName { get; set; }
    public DateTime AppointmentDate { get; set; }
    public TimeSpan AppointmentTime { get; set; }
    public AppointmentStatus Status { get; set; }
    public string Notes { get; set; }
    public decimal Fee { get; set; }
}
```

---

## ?? Authentication

### ????? ???????:
```
1. User POSTs ??? /api/account/register ?? ????????
2. ??? ?????? ?? ???????? ??????? ?? ??? ???? ?????? ?????????? ??????
3. ??? ????? ???? ????
```

### ????? ????? ??????:
```
1. User POSTs ??? /api/account/login ?? ??? ????????/?????? ????? ??????
2. ??? ?????? ?? ?????? ????????
3. ??? ????? JWT Token
4. ?????? Token ?? Authorization Header
```

### ??????? Token:
```
Header: Authorization: Bearer {token}
```

---

## ?? ????? ??? Endpoints

### 1. ????? ???? ????
```bash
POST /api/account/register
Content-Type: application/json

{
  "userName": "john_doe",
  "email": "john@example.com",
  "password": "Password123!",
  "address": "123 Main St"
}
```

### 2. ????? ??????
```bash
POST /api/account/login
Content-Type: application/json

{
  "userName": "john_doe",
  "password": "Password123!"
}

Response:
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### 3. ?????? ??? ????? ???????
```bash
GET /api/doctors
Authorization: Bearer {token}

Response:
[
  {
    "id": 1,
    "name": "Dr. Ahmed",
    "specialty": "Cardiology",
    "city": "Cairo",
    "area": "Zamalek",
    "consultationFee": 250.00
  }
]
```

### 4. ????? ?? ?????
```bash
POST /api/doctors/search
Content-Type: application/json
Authorization: Bearer {token}

{
  "specialtyId": 1,
  "locationId": 2,
  "searchTerm": "Ahmed"
}
```

### 5. ????? ??? ????
```bash
POST /api/appointments/patient/1
Content-Type: application/json
Authorization: Bearer {token}

{
  "doctorId": 1,
  "appointmentDate": "2025-01-15",
  "appointmentTime": "10:30:00",
  "notes": "Regular checkup"
}

Response: 201 Created
```

### 6. ????? ??????
```bash
POST /api/reviews/patient/1
Content-Type: application/json
Authorization: Bearer {token}

{
  "doctorId": 1,
  "appointmentId": 5,
  "rating": 5,
  "comment": "Excellent doctor!"
}

Response: 201 Created
```

### 7. ?????? ??? ????? ????? ??????
```bash
GET /api/reviews/doctor/1/average-rating

Response:
{
  "doctorId": 1,
  "averageRating": 4.5
}
```

### 8. ????? ???
```bash
PUT /api/appointments/1/cancel
Content-Type: application/json
Authorization: Bearer {token}

{
  "reason": "Unable to attend"
}

Response: 204 No Content
```

---

## ?? ???????

### ?????????:
- .NET 9
- SQL Server
- Visual Studio ?? VS Code

### ????? ???????:

1. **??????? ?????:**
```bash
dotnet restore
```

2. **????? ??? Migrations:**
```bash
dotnet ef database update
```

3. **????? ???????:**
```bash
dotnet run
```

4. **?????? ??? Swagger:**
```
https://localhost:7035/swagger/index.html
```

---

## ?? Configuration

### appsettings.json:
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=.;Database=MedicalDB;Trusted_Connection=true;TrustServerCertificate=true;"
  },
  "jwt": {
    "key": "your-secret-key-here-minimum-32-characters",
    "issuer": "YourIssuer",
    "audience": "YourAudience"
  }
}
```

---

## ?? Database Schema

### Tables:
- **AspNetUsers** - ?????????? (??????? ???????)
- **Doctors** - ???????
- **Patients** - ??????
- **Appointments** - ????????
- **Locations** - ??????? ?????????
- **Specialties** - ???????? ??????
- **Reviews** - ????????? ???????
- **TimeSlots** - ??????? ??????? ???????
- **DoctorSchedules** - ????? ??? ???????

---

## ? ????? ???????? ???????

- ? CRUD ???? ????? ????????
- ? JWT Authentication
- ? Service Layer
- ? Repository Pattern
- ? Unit of Work Pattern
- ? Validation ??? ??? DTOs
- ? Error Handling ????
- ? Swagger Documentation
- ? CORS ????
- ? Soft Delete (????? ???????)
- ? Exception Handling ?? ???? Endpoints

---

## ?? ??????? ????

1. ???? ??? Endpoints ????? ?? JWT ?? ???:
   - `GET /api/doctors` - ????? ?? ??????? ???? ??????
   - `GET /api/doctors/search`
   - `GET /api/specialty` - ????????
   - `GET /api/reviews/doctor/{id}` - ??????? ??????
   - `/api/account/register` ? `/api/account/login`

2. ????? ????? ??:
   - ???? ?????? ???????
   - ??? ???? ??? ?? ??? ??????

3. ?????????:
   - ???? ????? ????? ??????? ???
   - ????? ???? ??? ??? ???

---

## ?? ??????? ???????

- [JWT Token Decoder](https://jwt.io/)
- [Swagger/OpenAPI](https://swagger.io/)
- [Entity Framework Core Docs](https://learn.microsoft.com/en-us/ef/core/)
- [ASP.NET Core Security](https://learn.microsoft.com/en-us/aspnet/core/security/)

---

**?? ?????? ??????:** GitHub Copilot  
**??? ?????:** 2025
